export const entityManager={entities:[],init(){this.initDragAndDrop(),this.loadSavedEntities()},initDragAndDrop(){const t=document.querySelectorAll(".entity");t.forEach(t=>{t.addEventListener("dragstart",t=>this.handleDragStart(t)),t.addEventListener("dragend",t=>this.handleDragEnd(t))});const e=document.querySelector(".diagram-area");e&&(e.addEventListener("dragover",t=>this.handleDragOver(t)),e.addEventListener("drop",t=>this.handleDrop(t)))},handleDragStart(t){t.dataTransfer.setData("text/plain",t.target.dataset.type),t.target.classList.add("dragging")},handleDragEnd(t){t.target.classList.remove("dragging")},handleDragOver(t){t.preventDefault(),t.dataTransfer.dropEffect="copy"},handleDrop(t){t.preventDefault();const e=t.dataTransfer.getData("text/plain"),a=t.target.getBoundingClientRect(),n={id:Date.now(),type:e,x:t.clientX-a.left,y:t.clientY-a.top,attributes:[]};this.createEntityElement(n),this.entities.push(n),this.saveEntities()},createEntityElement(t){const e=document.createElement("div");e.className="entity-diagram",e.dataset.id=t.id,e.style.position="absolute",e.style.left=`${t.x}px`,e.style.top=`${t.y}px`;const a=document.createElement("div");a.className="entity-title",a.textContent=t.type;const n=document.createElement("div");n.className="entity-attributes",e.appendChild(a),e.appendChild(n),document.querySelector(".diagram-area").appendChild(e),this.makeEntityDraggable(e)},makeEntityDraggable(t){let e=0,a=0,n=0,i=0;t.addEventListener("mousedown",s=>{s.preventDefault(),n=s.clientX-t.offsetLeft,i=s.clientY-t.offsetTop,document.addEventListener("mousemove",d),document.addEventListener("mouseup",r)});const d=s=>{s.preventDefault(),e=s.clientX-n,a=s.clientY-i,t.style.left=e+"px",t.style.top=a+"px"},r=()=>{document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",r)}},loadSavedEntities(){const t=localStorage.getItem("entities");t&&(this.entities=JSON.parse(t),this.entities.forEach(t=>this.createEntityElement(t)))},saveEntities(){localStorage.setItem("entities",JSON.stringify(this.entities))}}; 